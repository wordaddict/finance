"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/expenses/route";
exports.ids = ["app/api/expenses/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "argon2":
/*!*************************!*\
  !*** external "argon2" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("argon2");

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fexpenses%2Froute&page=%2Fapi%2Fexpenses%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fexpenses%2Froute.ts&appDir=%2FUsers%2Fmichealadeyinka%2FDocuments%2Fcodebase%2Fcci%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmichealadeyinka%2FDocuments%2Fcodebase%2Fcci&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fexpenses%2Froute&page=%2Fapi%2Fexpenses%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fexpenses%2Froute.ts&appDir=%2FUsers%2Fmichealadeyinka%2FDocuments%2Fcodebase%2Fcci%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmichealadeyinka%2FDocuments%2Fcodebase%2Fcci&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_michealadeyinka_Documents_codebase_cci_src_app_api_expenses_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/expenses/route.ts */ \"(rsc)/./src/app/api/expenses/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/expenses/route\",\n        pathname: \"/api/expenses\",\n        filename: \"route\",\n        bundlePath: \"app/api/expenses/route\"\n    },\n    resolvedPagePath: \"/Users/michealadeyinka/Documents/codebase/cci/src/app/api/expenses/route.ts\",\n    nextConfigOutput,\n    userland: _Users_michealadeyinka_Documents_codebase_cci_src_app_api_expenses_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/expenses/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZleHBlbnNlcyUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGZXhwZW5zZXMlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZleHBlbnNlcyUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRm1pY2hlYWxhZGV5aW5rYSUyRkRvY3VtZW50cyUyRmNvZGViYXNlJTJGY2NpJTJGc3JjJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRm1pY2hlYWxhZGV5aW5rYSUyRkRvY3VtZW50cyUyRmNvZGViYXNlJTJGY2NpJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQzJCO0FBQ3hHO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsdUdBQXVHO0FBQy9HO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDNko7O0FBRTdKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY2h1cmNoLWV4cGVuc2UtbXZwLz9kMGMxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9taWNoZWFsYWRleWlua2EvRG9jdW1lbnRzL2NvZGViYXNlL2NjaS9zcmMvYXBwL2FwaS9leHBlbnNlcy9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvZXhwZW5zZXMvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9leHBlbnNlc1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvZXhwZW5zZXMvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvbWljaGVhbGFkZXlpbmthL0RvY3VtZW50cy9jb2RlYmFzZS9jY2kvc3JjL2FwcC9hcGkvZXhwZW5zZXMvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0IH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvZXhwZW5zZXMvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0LCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fexpenses%2Froute&page=%2Fapi%2Fexpenses%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fexpenses%2Froute.ts&appDir=%2FUsers%2Fmichealadeyinka%2FDocuments%2Fcodebase%2Fcci%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmichealadeyinka%2FDocuments%2Fcodebase%2Fcci&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/expenses/route.ts":
/*!***************************************!*\
  !*** ./src/app/api/expenses/route.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./src/lib/db.ts\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./src/lib/auth.ts\");\n/* harmony import */ var _lib_rbac__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/rbac */ \"(rsc)/./src/lib/rbac.ts\");\n\n\n\n\nasync function GET(request) {\n    try {\n        const user = await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_2__.requireAuth)();\n        const { searchParams } = new URL(request.url);\n        const status = searchParams.get(\"status\");\n        const team = searchParams.get(\"team\");\n        const campus = searchParams.get(\"campus\");\n        const search = searchParams.get(\"search\");\n        const page = parseInt(searchParams.get(\"page\") || \"1\");\n        const limit = parseInt(searchParams.get(\"limit\") || \"20\");\n        // Base where clause - users can only see their own expenses unless they have view all permissions\n        const baseWhere = (0,_lib_rbac__WEBPACK_IMPORTED_MODULE_3__.canViewAllExpenses)(user) ? {} : {\n            requesterId: user.id\n        };\n        // Build where clause\n        const where = {\n            ...baseWhere\n        };\n        if (status) {\n            where.status = status;\n        }\n        if (team) {\n            where.team = team;\n        }\n        if (campus) {\n            where.campus = campus;\n        }\n        if (search) {\n            where.OR = [\n                {\n                    title: {\n                        contains: search,\n                        mode: \"insensitive\"\n                    }\n                },\n                {\n                    description: {\n                        contains: search,\n                        mode: \"insensitive\"\n                    }\n                }\n            ];\n        }\n        // Get expenses with pagination\n        const [expenses, total] = await Promise.all([\n            _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.expenseRequest.findMany({\n                where,\n                include: {\n                    requester: true\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                },\n                skip: (page - 1) * limit,\n                take: limit\n            }),\n            _lib_db__WEBPACK_IMPORTED_MODULE_1__.db.expenseRequest.count({\n                where\n            })\n        ]);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            expenses,\n            pagination: {\n                page,\n                limit,\n                total,\n                pages: Math.ceil(total / limit)\n            }\n        });\n    } catch (error) {\n        console.error(\"Fetch expenses error:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Failed to fetch expenses\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9leHBlbnNlcy9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUF1RDtBQUMxQjtBQUNXO0FBQ087QUFFeEMsZUFBZUksSUFBSUMsT0FBb0I7SUFDNUMsSUFBSTtRQUNGLE1BQU1DLE9BQU8sTUFBTUosc0RBQVdBO1FBQzlCLE1BQU0sRUFBRUssWUFBWSxFQUFFLEdBQUcsSUFBSUMsSUFBSUgsUUFBUUksR0FBRztRQUU1QyxNQUFNQyxTQUFTSCxhQUFhSSxHQUFHLENBQUM7UUFDaEMsTUFBTUMsT0FBT0wsYUFBYUksR0FBRyxDQUFDO1FBQzlCLE1BQU1FLFNBQVNOLGFBQWFJLEdBQUcsQ0FBQztRQUNoQyxNQUFNRyxTQUFTUCxhQUFhSSxHQUFHLENBQUM7UUFDaEMsTUFBTUksT0FBT0MsU0FBU1QsYUFBYUksR0FBRyxDQUFDLFdBQVc7UUFDbEQsTUFBTU0sUUFBUUQsU0FBU1QsYUFBYUksR0FBRyxDQUFDLFlBQVk7UUFFcEQsa0dBQWtHO1FBQ2xHLE1BQU1PLFlBQVlmLDZEQUFrQkEsQ0FBQ0csUUFBUSxDQUFDLElBQUk7WUFDaERhLGFBQWFiLEtBQUtjLEVBQUU7UUFDdEI7UUFFQSxxQkFBcUI7UUFDckIsTUFBTUMsUUFBYTtZQUFFLEdBQUdILFNBQVM7UUFBQztRQUVsQyxJQUFJUixRQUFRO1lBQ1ZXLE1BQU1YLE1BQU0sR0FBR0E7UUFDakI7UUFFQSxJQUFJRSxNQUFNO1lBQ1JTLE1BQU1ULElBQUksR0FBR0E7UUFDZjtRQUVBLElBQUlDLFFBQVE7WUFDVlEsTUFBTVIsTUFBTSxHQUFHQTtRQUNqQjtRQUVBLElBQUlDLFFBQVE7WUFDVk8sTUFBTUMsRUFBRSxHQUFHO2dCQUNUO29CQUFFQyxPQUFPO3dCQUFFQyxVQUFVVjt3QkFBUVcsTUFBTTtvQkFBYztnQkFBRTtnQkFDbkQ7b0JBQUVDLGFBQWE7d0JBQUVGLFVBQVVWO3dCQUFRVyxNQUFNO29CQUFjO2dCQUFFO2FBQzFEO1FBQ0g7UUFFQSwrQkFBK0I7UUFDL0IsTUFBTSxDQUFDRSxVQUFVQyxNQUFNLEdBQUcsTUFBTUMsUUFBUUMsR0FBRyxDQUFDO1lBQzFDN0IsdUNBQUVBLENBQUM4QixjQUFjLENBQUNDLFFBQVEsQ0FBQztnQkFDekJYO2dCQUNBWSxTQUFTO29CQUNQQyxXQUFXO2dCQUNiO2dCQUNBQyxTQUFTO29CQUNQQyxXQUFXO2dCQUNiO2dCQUNBQyxNQUFNLENBQUN0QixPQUFPLEtBQUtFO2dCQUNuQnFCLE1BQU1yQjtZQUNSO1lBQ0FoQix1Q0FBRUEsQ0FBQzhCLGNBQWMsQ0FBQ1EsS0FBSyxDQUFDO2dCQUFFbEI7WUFBTTtTQUNqQztRQUVELE9BQU9yQixrRkFBWUEsQ0FBQ3dDLElBQUksQ0FBQztZQUN2QmI7WUFDQWMsWUFBWTtnQkFDVjFCO2dCQUNBRTtnQkFDQVc7Z0JBQ0FjLE9BQU9DLEtBQUtDLElBQUksQ0FBQ2hCLFFBQVFYO1lBQzNCO1FBQ0Y7SUFDRixFQUFFLE9BQU80QixPQUFPO1FBQ2RDLFFBQVFELEtBQUssQ0FBQyx5QkFBeUJBO1FBQ3ZDLE9BQU83QyxrRkFBWUEsQ0FBQ3dDLElBQUksQ0FDdEI7WUFBRUssT0FBTztRQUEyQixHQUNwQztZQUFFbkMsUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jaHVyY2gtZXhwZW5zZS1tdnAvLi9zcmMvYXBwL2FwaS9leHBlbnNlcy9yb3V0ZS50cz81MGM4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcbmltcG9ydCB7IGRiIH0gZnJvbSAnQC9saWIvZGInXG5pbXBvcnQgeyByZXF1aXJlQXV0aCB9IGZyb20gJ0AvbGliL2F1dGgnXG5pbXBvcnQgeyBjYW5WaWV3QWxsRXhwZW5zZXMgfSBmcm9tICdAL2xpYi9yYmFjJ1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IHJlcXVpcmVBdXRoKClcbiAgICBjb25zdCB7IHNlYXJjaFBhcmFtcyB9ID0gbmV3IFVSTChyZXF1ZXN0LnVybClcbiAgICBcbiAgICBjb25zdCBzdGF0dXMgPSBzZWFyY2hQYXJhbXMuZ2V0KCdzdGF0dXMnKVxuICAgIGNvbnN0IHRlYW0gPSBzZWFyY2hQYXJhbXMuZ2V0KCd0ZWFtJylcbiAgICBjb25zdCBjYW1wdXMgPSBzZWFyY2hQYXJhbXMuZ2V0KCdjYW1wdXMnKVxuICAgIGNvbnN0IHNlYXJjaCA9IHNlYXJjaFBhcmFtcy5nZXQoJ3NlYXJjaCcpXG4gICAgY29uc3QgcGFnZSA9IHBhcnNlSW50KHNlYXJjaFBhcmFtcy5nZXQoJ3BhZ2UnKSB8fCAnMScpXG4gICAgY29uc3QgbGltaXQgPSBwYXJzZUludChzZWFyY2hQYXJhbXMuZ2V0KCdsaW1pdCcpIHx8ICcyMCcpXG5cbiAgICAvLyBCYXNlIHdoZXJlIGNsYXVzZSAtIHVzZXJzIGNhbiBvbmx5IHNlZSB0aGVpciBvd24gZXhwZW5zZXMgdW5sZXNzIHRoZXkgaGF2ZSB2aWV3IGFsbCBwZXJtaXNzaW9uc1xuICAgIGNvbnN0IGJhc2VXaGVyZSA9IGNhblZpZXdBbGxFeHBlbnNlcyh1c2VyKSA/IHt9IDoge1xuICAgICAgcmVxdWVzdGVySWQ6IHVzZXIuaWQsXG4gICAgfVxuXG4gICAgLy8gQnVpbGQgd2hlcmUgY2xhdXNlXG4gICAgY29uc3Qgd2hlcmU6IGFueSA9IHsgLi4uYmFzZVdoZXJlIH1cbiAgICBcbiAgICBpZiAoc3RhdHVzKSB7XG4gICAgICB3aGVyZS5zdGF0dXMgPSBzdGF0dXNcbiAgICB9XG4gICAgXG4gICAgaWYgKHRlYW0pIHtcbiAgICAgIHdoZXJlLnRlYW0gPSB0ZWFtXG4gICAgfVxuICAgIFxuICAgIGlmIChjYW1wdXMpIHtcbiAgICAgIHdoZXJlLmNhbXB1cyA9IGNhbXB1c1xuICAgIH1cbiAgICBcbiAgICBpZiAoc2VhcmNoKSB7XG4gICAgICB3aGVyZS5PUiA9IFtcbiAgICAgICAgeyB0aXRsZTogeyBjb250YWluczogc2VhcmNoLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcbiAgICAgICAgeyBkZXNjcmlwdGlvbjogeyBjb250YWluczogc2VhcmNoLCBtb2RlOiAnaW5zZW5zaXRpdmUnIH0gfSxcbiAgICAgIF1cbiAgICB9XG5cbiAgICAvLyBHZXQgZXhwZW5zZXMgd2l0aCBwYWdpbmF0aW9uXG4gICAgY29uc3QgW2V4cGVuc2VzLCB0b3RhbF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICBkYi5leHBlbnNlUmVxdWVzdC5maW5kTWFueSh7XG4gICAgICAgIHdoZXJlLFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgcmVxdWVzdGVyOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgICBvcmRlckJ5OiB7XG4gICAgICAgICAgY3JlYXRlZEF0OiAnZGVzYycsXG4gICAgICAgIH0sXG4gICAgICAgIHNraXA6IChwYWdlIC0gMSkgKiBsaW1pdCxcbiAgICAgICAgdGFrZTogbGltaXQsXG4gICAgICB9KSxcbiAgICAgIGRiLmV4cGVuc2VSZXF1ZXN0LmNvdW50KHsgd2hlcmUgfSksXG4gICAgXSlcblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBleHBlbnNlcyxcbiAgICAgIHBhZ2luYXRpb246IHtcbiAgICAgICAgcGFnZSxcbiAgICAgICAgbGltaXQsXG4gICAgICAgIHRvdGFsLFxuICAgICAgICBwYWdlczogTWF0aC5jZWlsKHRvdGFsIC8gbGltaXQpLFxuICAgICAgfSxcbiAgICB9KVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0ZldGNoIGV4cGVuc2VzIGVycm9yOicsIGVycm9yKVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6ICdGYWlsZWQgdG8gZmV0Y2ggZXhwZW5zZXMnIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApXG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJkYiIsInJlcXVpcmVBdXRoIiwiY2FuVmlld0FsbEV4cGVuc2VzIiwiR0VUIiwicmVxdWVzdCIsInVzZXIiLCJzZWFyY2hQYXJhbXMiLCJVUkwiLCJ1cmwiLCJzdGF0dXMiLCJnZXQiLCJ0ZWFtIiwiY2FtcHVzIiwic2VhcmNoIiwicGFnZSIsInBhcnNlSW50IiwibGltaXQiLCJiYXNlV2hlcmUiLCJyZXF1ZXN0ZXJJZCIsImlkIiwid2hlcmUiLCJPUiIsInRpdGxlIiwiY29udGFpbnMiLCJtb2RlIiwiZGVzY3JpcHRpb24iLCJleHBlbnNlcyIsInRvdGFsIiwiUHJvbWlzZSIsImFsbCIsImV4cGVuc2VSZXF1ZXN0IiwiZmluZE1hbnkiLCJpbmNsdWRlIiwicmVxdWVzdGVyIiwib3JkZXJCeSIsImNyZWF0ZWRBdCIsInNraXAiLCJ0YWtlIiwiY291bnQiLCJqc29uIiwicGFnaW5hdGlvbiIsInBhZ2VzIiwiTWF0aCIsImNlaWwiLCJlcnJvciIsImNvbnNvbGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/expenses/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/auth.ts":
/*!*************************!*\
  !*** ./src/lib/auth.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clearSessionCookie: () => (/* binding */ clearSessionCookie),\n/* harmony export */   createSession: () => (/* binding */ createSession),\n/* harmony export */   deleteSession: () => (/* binding */ deleteSession),\n/* harmony export */   getCurrentUser: () => (/* binding */ getCurrentUser),\n/* harmony export */   getSession: () => (/* binding */ getSession),\n/* harmony export */   hashPassword: () => (/* binding */ hashPassword),\n/* harmony export */   requireAuth: () => (/* binding */ requireAuth),\n/* harmony export */   requireRole: () => (/* binding */ requireRole),\n/* harmony export */   setSessionCookie: () => (/* binding */ setSessionCookie),\n/* harmony export */   verifyPassword: () => (/* binding */ verifyPassword)\n/* harmony export */ });\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/headers.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_headers__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./db */ \"(rsc)/./src/lib/db.ts\");\n/* harmony import */ var argon2__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! argon2 */ \"argon2\");\n/* harmony import */ var argon2__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(argon2__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_3__);\n\n\n\n\nasync function hashPassword(password) {\n    return await (0,argon2__WEBPACK_IMPORTED_MODULE_2__.hash)(password);\n}\nasync function verifyPassword(password, hashedPassword) {\n    try {\n        return await (0,argon2__WEBPACK_IMPORTED_MODULE_2__.verify)(hashedPassword, password);\n    } catch  {\n        return false;\n    }\n}\nasync function createSession(userId, request) {\n    const sessionId = (0,crypto__WEBPACK_IMPORTED_MODULE_3__.randomBytes)(32).toString(\"hex\");\n    const expiresAt = new Date(Date.now() + 30 * 24 * 60 * 60 * 1000) // 30 days\n    ;\n    await _db__WEBPACK_IMPORTED_MODULE_1__.db.session.create({\n        data: {\n            id: sessionId,\n            userId,\n            ip: request.ip || request.headers.get(\"x-forwarded-for\") || \"unknown\",\n            userAgent: request.headers.get(\"user-agent\") || \"unknown\",\n            expiresAt\n        }\n    });\n    return sessionId;\n}\nasync function getSession(sessionId) {\n    const session = await _db__WEBPACK_IMPORTED_MODULE_1__.db.session.findUnique({\n        where: {\n            id: sessionId\n        },\n        include: {\n            user: true\n        }\n    });\n    if (!session || session.expiresAt < new Date()) {\n        return null;\n    }\n    return {\n        id: session.user.id,\n        email: session.user.email,\n        name: session.user.name,\n        role: session.user.role\n    };\n}\nasync function deleteSession(sessionId) {\n    await _db__WEBPACK_IMPORTED_MODULE_1__.db.session.delete({\n        where: {\n            id: sessionId\n        }\n    });\n}\nasync function getCurrentUser() {\n    const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n    const sessionId = cookieStore.get(\"session\")?.value;\n    if (!sessionId) {\n        return null;\n    }\n    return await getSession(sessionId);\n}\nfunction setSessionCookie(sessionId, response) {\n    response.cookies.set(\"session\", sessionId, {\n        httpOnly: true,\n        secure: \"development\" === \"production\",\n        sameSite: \"lax\",\n        maxAge: 30 * 24 * 60 * 60\n    });\n}\nfunction clearSessionCookie(response) {\n    response.cookies.delete(\"session\");\n}\nasync function requireAuth() {\n    const user = await getCurrentUser();\n    if (!user) {\n        throw new Error(\"Authentication required\");\n    }\n    return user;\n}\nasync function requireRole(allowedRoles) {\n    const user = await requireAuth();\n    if (!allowedRoles.includes(user.role)) {\n        throw new Error(\"Insufficient permissions\");\n    }\n    return user;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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bnNlLW12cC8uL3NyYy9saWIvYXV0aC50cz82NjkyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcbmltcG9ydCB7IGNvb2tpZXMgfSBmcm9tICduZXh0L2hlYWRlcnMnXG5pbXBvcnQgeyBkYiB9IGZyb20gJy4vZGInXG5pbXBvcnQgeyBoYXNoLCB2ZXJpZnkgfSBmcm9tICdhcmdvbjInXG5pbXBvcnQgeyByYW5kb21CeXRlcyB9IGZyb20gJ2NyeXB0bydcblxuZXhwb3J0IGludGVyZmFjZSBTZXNzaW9uVXNlciB7XG4gIGlkOiBzdHJpbmdcbiAgZW1haWw6IHN0cmluZ1xuICBuYW1lOiBzdHJpbmcgfCBudWxsXG4gIHJvbGU6ICdBRE1JTicgfCAnQ0FNUFVTX1BBU1RPUicgfCAnTEVBREVSJ1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFzaFBhc3N3b3JkKHBhc3N3b3JkOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICByZXR1cm4gYXdhaXQgaGFzaChwYXNzd29yZClcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZlcmlmeVBhc3N3b3JkKHBhc3N3b3JkOiBzdHJpbmcsIGhhc2hlZFBhc3N3b3JkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gYXdhaXQgdmVyaWZ5KGhhc2hlZFBhc3N3b3JkLCBwYXNzd29yZClcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVNlc3Npb24odXNlcklkOiBzdHJpbmcsIHJlcXVlc3Q6IE5leHRSZXF1ZXN0KTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgY29uc3Qgc2Vzc2lvbklkID0gcmFuZG9tQnl0ZXMoMzIpLnRvU3RyaW5nKCdoZXgnKVxuICBjb25zdCBleHBpcmVzQXQgPSBuZXcgRGF0ZShEYXRlLm5vdygpICsgMzAgKiAyNCAqIDYwICogNjAgKiAxMDAwKSAvLyAzMCBkYXlzXG5cbiAgYXdhaXQgZGIuc2Vzc2lvbi5jcmVhdGUoe1xuICAgIGRhdGE6IHtcbiAgICAgIGlkOiBzZXNzaW9uSWQsXG4gICAgICB1c2VySWQsXG4gICAgICBpcDogcmVxdWVzdC5pcCB8fCByZXF1ZXN0LmhlYWRlcnMuZ2V0KCd4LWZvcndhcmRlZC1mb3InKSB8fCAndW5rbm93bicsXG4gICAgICB1c2VyQWdlbnQ6IHJlcXVlc3QuaGVhZGVycy5nZXQoJ3VzZXItYWdlbnQnKSB8fCAndW5rbm93bicsXG4gICAgICBleHBpcmVzQXQsXG4gICAgfSxcbiAgfSlcblxuICByZXR1cm4gc2Vzc2lvbklkXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTZXNzaW9uKHNlc3Npb25JZDogc3RyaW5nKTogUHJvbWlzZTxTZXNzaW9uVXNlciB8IG51bGw+IHtcbiAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGRiLnNlc3Npb24uZmluZFVuaXF1ZSh7XG4gICAgd2hlcmU6IHsgaWQ6IHNlc3Npb25JZCB9LFxuICAgIGluY2x1ZGU6IHsgdXNlcjogdHJ1ZSB9LFxuICB9KVxuXG4gIGlmICghc2Vzc2lvbiB8fCBzZXNzaW9uLmV4cGlyZXNBdCA8IG5ldyBEYXRlKCkpIHtcbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBpZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgIGVtYWlsOiBzZXNzaW9uLnVzZXIuZW1haWwsXG4gICAgbmFtZTogc2Vzc2lvbi51c2VyLm5hbWUsXG4gICAgcm9sZTogc2Vzc2lvbi51c2VyLnJvbGUgYXMgJ0FETUlOJyB8ICdDQU1QVVNfUEFTVE9SJyB8ICdMRUFERVInLFxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVTZXNzaW9uKHNlc3Npb25JZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gIGF3YWl0IGRiLnNlc3Npb24uZGVsZXRlKHtcbiAgICB3aGVyZTogeyBpZDogc2Vzc2lvbklkIH0sXG4gIH0pXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDdXJyZW50VXNlcigpOiBQcm9taXNlPFNlc3Npb25Vc2VyIHwgbnVsbD4ge1xuICBjb25zdCBjb29raWVTdG9yZSA9IGNvb2tpZXMoKVxuICBjb25zdCBzZXNzaW9uSWQgPSBjb29raWVTdG9yZS5nZXQoJ3Nlc3Npb24nKT8udmFsdWVcblxuICBpZiAoIXNlc3Npb25JZCkge1xuICAgIHJldHVybiBudWxsXG4gIH1cblxuICByZXR1cm4gYXdhaXQgZ2V0U2Vzc2lvbihzZXNzaW9uSWQpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzZXRTZXNzaW9uQ29va2llKHNlc3Npb25JZDogc3RyaW5nLCByZXNwb25zZTogTmV4dFJlc3BvbnNlKTogdm9pZCB7XG4gIHJlc3BvbnNlLmNvb2tpZXMuc2V0KCdzZXNzaW9uJywgc2Vzc2lvbklkLCB7XG4gICAgaHR0cE9ubHk6IHRydWUsXG4gICAgc2VjdXJlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nLFxuICAgIHNhbWVTaXRlOiAnbGF4JyxcbiAgICBtYXhBZ2U6IDMwICogMjQgKiA2MCAqIDYwLCAvLyAzMCBkYXlzXG4gIH0pXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjbGVhclNlc3Npb25Db29raWUocmVzcG9uc2U6IE5leHRSZXNwb25zZSk6IHZvaWQge1xuICByZXNwb25zZS5jb29raWVzLmRlbGV0ZSgnc2Vzc2lvbicpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXF1aXJlQXV0aCgpOiBQcm9taXNlPFNlc3Npb25Vc2VyPiB7XG4gIGNvbnN0IHVzZXIgPSBhd2FpdCBnZXRDdXJyZW50VXNlcigpXG4gIGlmICghdXNlcikge1xuICAgIHRocm93IG5ldyBFcnJvcignQXV0aGVudGljYXRpb24gcmVxdWlyZWQnKVxuICB9XG4gIHJldHVybiB1c2VyXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXF1aXJlUm9sZShhbGxvd2VkUm9sZXM6IHN0cmluZ1tdKTogUHJvbWlzZTxTZXNzaW9uVXNlcj4ge1xuICBjb25zdCB1c2VyID0gYXdhaXQgcmVxdWlyZUF1dGgoKVxuICBpZiAoIWFsbG93ZWRSb2xlcy5pbmNsdWRlcyh1c2VyLnJvbGUpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdJbnN1ZmZpY2llbnQgcGVybWlzc2lvbnMnKVxuICB9XG4gIHJldHVybiB1c2VyXG59XG4iXSwibmFtZXMiOlsiY29va2llcyIsImRiIiwiaGFzaCIsInZlcmlmeSIsInJhbmRvbUJ5dGVzIiwiaGFzaFBhc3N3b3JkIiwicGFzc3dvcmQiLCJ2ZXJpZnlQYXNzd29yZCIsImhhc2hlZFBhc3N3b3JkIiwiY3JlYXRlU2Vzc2lvbiIsInVzZXJJZCIsInJlcXVlc3QiLCJzZXNzaW9uSWQiLCJ0b1N0cmluZyIsImV4cGlyZXNBdCIsIkRhdGUiLCJub3ciLCJzZXNzaW9uIiwiY3JlYXRlIiwiZGF0YSIsImlkIiwiaXAiLCJoZWFkZXJzIiwiZ2V0IiwidXNlckFnZW50IiwiZ2V0U2Vzc2lvbiIsImZpbmRVbmlxdWUiLCJ3aGVyZSIsImluY2x1ZGUiLCJ1c2VyIiwiZW1haWwiLCJuYW1lIiwicm9sZSIsImRlbGV0ZVNlc3Npb24iLCJkZWxldGUiLCJnZXRDdXJyZW50VXNlciIsImNvb2tpZVN0b3JlIiwidmFsdWUiLCJzZXRTZXNzaW9uQ29va2llIiwicmVzcG9uc2UiLCJzZXQiLCJodHRwT25seSIsInNlY3VyZSIsInByb2Nlc3MiLCJzYW1lU2l0ZSIsIm1heEFnZSIsImNsZWFyU2Vzc2lvbkNvb2tpZSIsInJlcXVpcmVBdXRoIiwiRXJyb3IiLCJyZXF1aXJlUm9sZSIsImFsbG93ZWRSb2xlcyIsImluY2x1ZGVzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/db.ts":
/*!***********************!*\
  !*** ./src/lib/db.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   db: () => (/* binding */ db)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst globalForPrisma = globalThis;\nconst db = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\nif (true) globalForPrisma.prisma = db;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2RiLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUE2QztBQUU3QyxNQUFNQyxrQkFBa0JDO0FBSWpCLE1BQU1DLEtBQUtGLGdCQUFnQkcsTUFBTSxJQUFJLElBQUlKLHdEQUFZQSxHQUFFO0FBRTlELElBQUlLLElBQXlCLEVBQWNKLGdCQUFnQkcsTUFBTSxHQUFHRCIsInNvdXJjZXMiOlsid2VicGFjazovL2NodXJjaC1leHBlbnNlLW12cC8uL3NyYy9saWIvZGIudHM/OWU0ZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcmlzbWFDbGllbnQgfSBmcm9tICdAcHJpc21hL2NsaWVudCdcblxuY29uc3QgZ2xvYmFsRm9yUHJpc21hID0gZ2xvYmFsVGhpcyBhcyB1bmtub3duIGFzIHtcbiAgcHJpc21hOiBQcmlzbWFDbGllbnQgfCB1bmRlZmluZWRcbn1cblxuZXhwb3J0IGNvbnN0IGRiID0gZ2xvYmFsRm9yUHJpc21hLnByaXNtYSA/PyBuZXcgUHJpc21hQ2xpZW50KClcblxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPSBkYlxuIl0sIm5hbWVzIjpbIlByaXNtYUNsaWVudCIsImdsb2JhbEZvclByaXNtYSIsImdsb2JhbFRoaXMiLCJkYiIsInByaXNtYSIsInByb2Nlc3MiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/db.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/rbac.ts":
/*!*************************!*\
  !*** ./src/lib/rbac.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ROLE_HIERARCHY: () => (/* binding */ ROLE_HIERARCHY),\n/* harmony export */   canApproveAtStage: () => (/* binding */ canApproveAtStage),\n/* harmony export */   canApproveExpenses: () => (/* binding */ canApproveExpenses),\n/* harmony export */   canExportData: () => (/* binding */ canExportData),\n/* harmony export */   canManageTeams: () => (/* binding */ canManageTeams),\n/* harmony export */   canManageUsers: () => (/* binding */ canManageUsers),\n/* harmony export */   canMarkAsPaid: () => (/* binding */ canMarkAsPaid),\n/* harmony export */   canViewAllExpenses: () => (/* binding */ canViewAllExpenses),\n/* harmony export */   getApprovalStages: () => (/* binding */ getApprovalStages),\n/* harmony export */   hasRole: () => (/* binding */ hasRole)\n/* harmony export */ });\nconst ROLE_HIERARCHY = {\n    ADMIN: 3,\n    CAMPUS_PASTOR: 2,\n    LEADER: 1\n};\nfunction hasRole(user, requiredRole) {\n    return ROLE_HIERARCHY[user.role] >= ROLE_HIERARCHY[requiredRole];\n}\nfunction canApproveExpenses(user) {\n    return hasRole(user, \"CAMPUS_PASTOR\");\n}\nfunction canViewAllExpenses(user) {\n    return hasRole(user, \"CAMPUS_PASTOR\");\n}\nfunction canManageUsers(user) {\n    return hasRole(user, \"ADMIN\");\n}\nfunction canManageTeams(user) {\n    return hasRole(user, \"CAMPUS_PASTOR\");\n}\nfunction canMarkAsPaid(user) {\n    return hasRole(user, \"ADMIN\");\n}\nfunction canExportData(user) {\n    return hasRole(user, \"CAMPUS_PASTOR\");\n}\nfunction getApprovalStages(user) {\n    if (user.role === \"ADMIN\") {\n        return [\n            1,\n            2\n        ] // Can approve at both stages\n        ;\n    }\n    if (user.role === \"CAMPUS_PASTOR\") {\n        return [\n            1\n        ] // Can approve at first stage\n        ;\n    }\n    return [] // Leaders cannot approve\n    ;\n}\nfunction canApproveAtStage(user, stage) {\n    const allowedStages = getApprovalStages(user);\n    return allowedStages.includes(stage);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3JiYWMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUlPLE1BQU1BLGlCQUF1QztJQUNsREMsT0FBTztJQUNQQyxlQUFlO0lBQ2ZDLFFBQVE7QUFDVixFQUFDO0FBRU0sU0FBU0MsUUFBUUMsSUFBaUIsRUFBRUMsWUFBa0I7SUFDM0QsT0FBT04sY0FBYyxDQUFDSyxLQUFLRSxJQUFJLENBQUMsSUFBSVAsY0FBYyxDQUFDTSxhQUFhO0FBQ2xFO0FBRU8sU0FBU0UsbUJBQW1CSCxJQUFpQjtJQUNsRCxPQUFPRCxRQUFRQyxNQUFNO0FBQ3ZCO0FBRU8sU0FBU0ksbUJBQW1CSixJQUFpQjtJQUNsRCxPQUFPRCxRQUFRQyxNQUFNO0FBQ3ZCO0FBRU8sU0FBU0ssZUFBZUwsSUFBaUI7SUFDOUMsT0FBT0QsUUFBUUMsTUFBTTtBQUN2QjtBQUVPLFNBQVNNLGVBQWVOLElBQWlCO0lBQzlDLE9BQU9ELFFBQVFDLE1BQU07QUFDdkI7QUFFTyxTQUFTTyxjQUFjUCxJQUFpQjtJQUM3QyxPQUFPRCxRQUFRQyxNQUFNO0FBQ3ZCO0FBRU8sU0FBU1EsY0FBY1IsSUFBaUI7SUFDN0MsT0FBT0QsUUFBUUMsTUFBTTtBQUN2QjtBQUVPLFNBQVNTLGtCQUFrQlQsSUFBaUI7SUFDakQsSUFBSUEsS0FBS0UsSUFBSSxLQUFLLFNBQVM7UUFDekIsT0FBTztZQUFDO1lBQUc7U0FBRSxDQUFDLDZCQUE2Qjs7SUFDN0M7SUFDQSxJQUFJRixLQUFLRSxJQUFJLEtBQUssaUJBQWlCO1FBQ2pDLE9BQU87WUFBQztTQUFFLENBQUMsNkJBQTZCOztJQUMxQztJQUNBLE9BQU8sRUFBRSxDQUFDLHlCQUF5Qjs7QUFDckM7QUFFTyxTQUFTUSxrQkFBa0JWLElBQWlCLEVBQUVXLEtBQWE7SUFDaEUsTUFBTUMsZ0JBQWdCSCxrQkFBa0JUO0lBQ3hDLE9BQU9ZLGNBQWNDLFFBQVEsQ0FBQ0Y7QUFDaEMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jaHVyY2gtZXhwZW5zZS1tdnAvLi9zcmMvbGliL3JiYWMudHM/MzYzMSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTZXNzaW9uVXNlciB9IGZyb20gJy4vYXV0aCdcblxuZXhwb3J0IHR5cGUgUm9sZSA9ICdBRE1JTicgfCAnQ0FNUFVTX1BBU1RPUicgfCAnTEVBREVSJ1xuXG5leHBvcnQgY29uc3QgUk9MRV9ISUVSQVJDSFk6IFJlY29yZDxSb2xlLCBudW1iZXI+ID0ge1xuICBBRE1JTjogMyxcbiAgQ0FNUFVTX1BBU1RPUjogMixcbiAgTEVBREVSOiAxLFxufVxuXG5leHBvcnQgZnVuY3Rpb24gaGFzUm9sZSh1c2VyOiBTZXNzaW9uVXNlciwgcmVxdWlyZWRSb2xlOiBSb2xlKTogYm9vbGVhbiB7XG4gIHJldHVybiBST0xFX0hJRVJBUkNIWVt1c2VyLnJvbGVdID49IFJPTEVfSElFUkFSQ0hZW3JlcXVpcmVkUm9sZV1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNhbkFwcHJvdmVFeHBlbnNlcyh1c2VyOiBTZXNzaW9uVXNlcik6IGJvb2xlYW4ge1xuICByZXR1cm4gaGFzUm9sZSh1c2VyLCAnQ0FNUFVTX1BBU1RPUicpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjYW5WaWV3QWxsRXhwZW5zZXModXNlcjogU2Vzc2lvblVzZXIpOiBib29sZWFuIHtcbiAgcmV0dXJuIGhhc1JvbGUodXNlciwgJ0NBTVBVU19QQVNUT1InKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY2FuTWFuYWdlVXNlcnModXNlcjogU2Vzc2lvblVzZXIpOiBib29sZWFuIHtcbiAgcmV0dXJuIGhhc1JvbGUodXNlciwgJ0FETUlOJylcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNhbk1hbmFnZVRlYW1zKHVzZXI6IFNlc3Npb25Vc2VyKTogYm9vbGVhbiB7XG4gIHJldHVybiBoYXNSb2xlKHVzZXIsICdDQU1QVVNfUEFTVE9SJylcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNhbk1hcmtBc1BhaWQodXNlcjogU2Vzc2lvblVzZXIpOiBib29sZWFuIHtcbiAgcmV0dXJuIGhhc1JvbGUodXNlciwgJ0FETUlOJylcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNhbkV4cG9ydERhdGEodXNlcjogU2Vzc2lvblVzZXIpOiBib29sZWFuIHtcbiAgcmV0dXJuIGhhc1JvbGUodXNlciwgJ0NBTVBVU19QQVNUT1InKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0QXBwcm92YWxTdGFnZXModXNlcjogU2Vzc2lvblVzZXIpOiBudW1iZXJbXSB7XG4gIGlmICh1c2VyLnJvbGUgPT09ICdBRE1JTicpIHtcbiAgICByZXR1cm4gWzEsIDJdIC8vIENhbiBhcHByb3ZlIGF0IGJvdGggc3RhZ2VzXG4gIH1cbiAgaWYgKHVzZXIucm9sZSA9PT0gJ0NBTVBVU19QQVNUT1InKSB7XG4gICAgcmV0dXJuIFsxXSAvLyBDYW4gYXBwcm92ZSBhdCBmaXJzdCBzdGFnZVxuICB9XG4gIHJldHVybiBbXSAvLyBMZWFkZXJzIGNhbm5vdCBhcHByb3ZlXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjYW5BcHByb3ZlQXRTdGFnZSh1c2VyOiBTZXNzaW9uVXNlciwgc3RhZ2U6IG51bWJlcik6IGJvb2xlYW4ge1xuICBjb25zdCBhbGxvd2VkU3RhZ2VzID0gZ2V0QXBwcm92YWxTdGFnZXModXNlcilcbiAgcmV0dXJuIGFsbG93ZWRTdGFnZXMuaW5jbHVkZXMoc3RhZ2UpXG59XG4iXSwibmFtZXMiOlsiUk9MRV9ISUVSQVJDSFkiLCJBRE1JTiIsIkNBTVBVU19QQVNUT1IiLCJMRUFERVIiLCJoYXNSb2xlIiwidXNlciIsInJlcXVpcmVkUm9sZSIsInJvbGUiLCJjYW5BcHByb3ZlRXhwZW5zZXMiLCJjYW5WaWV3QWxsRXhwZW5zZXMiLCJjYW5NYW5hZ2VVc2VycyIsImNhbk1hbmFnZVRlYW1zIiwiY2FuTWFya0FzUGFpZCIsImNhbkV4cG9ydERhdGEiLCJnZXRBcHByb3ZhbFN0YWdlcyIsImNhbkFwcHJvdmVBdFN0YWdlIiwic3RhZ2UiLCJhbGxvd2VkU3RhZ2VzIiwiaW5jbHVkZXMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/rbac.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fexpenses%2Froute&page=%2Fapi%2Fexpenses%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fexpenses%2Froute.ts&appDir=%2FUsers%2Fmichealadeyinka%2FDocuments%2Fcodebase%2Fcci%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmichealadeyinka%2FDocuments%2Fcodebase%2Fcci&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();